name: CI
on:
 push:
  branches:
   - '*'
   - 'feature/*'
jobs:
 quality:
  name: Quality
  timeout-minutes: 5
  runs-on: ubuntu-20.04
  steps:
   - name: Git - Checkout
     uses: actions/checkout@v2

   - name: Install node modules
     run: |
      yarn

   - name: Lint
     run: |
      yarn lint

 test:
  name: Test
  timeout-minutes: 5
  runs-on: ubuntu-20.04
  needs: [quality]
  steps:
   - name: Git - Checkout
     uses: actions/checkout@v2

   - name: Install node modules
     run: |
      yarn

   - name: Lint
     run: |
      yarn test:unit

 deploy:
  name: Deploy
  timeout-minutes: 15
  runs-on: ubuntu-20.04
  needs: [quality, test]
  if: github.ref == 'refs/heads/main'
  steps:
   - name: Git - Checkout
     uses: actions/checkout@v2

   - name: Install node modules
     run: |
      yarn

   - name: Build project
     run: |
      yarn build

   - name: Deploy ðŸš€
     uses: JamesIves/github-pages-deploy-action@v4.2.5
     with:
      branch: gh-pages
      folder: dist
